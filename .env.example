# =====================================================
# AI-Powered CI/CD System - Environment Configuration
# =====================================================
# Copy this file to .env and update with your values

# =====================================================
# DATABASE CONFIGURATION
# =====================================================

# PostgreSQL Database Connection
DB_HOST=your-cloudflare-url.com
DB_PORT=5432
DB_NAME=codegen-taskmaster-db
DB_USER=software_developer
DB_PASSWORD=your-secure-password
DB_SSL_MODE=require

# Connection Pool Settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE_TIMEOUT=10000
DB_POOL_ACQUIRE_TIMEOUT=30000
DB_POOL_CREATE_TIMEOUT=30000
DB_POOL_DESTROY_TIMEOUT=5000
DB_POOL_REAP_INTERVAL=1000
DB_POOL_CREATE_RETRY_INTERVAL=200

# Query Configuration
DB_QUERY_TIMEOUT=60000
DB_SLOW_QUERY_THRESHOLD=1000
DB_LOG_QUERIES=false
DB_LOG_SLOW_QUERIES=true
DB_ENABLE_METRICS=true

# Connection Retry Logic
DB_RETRY_MAX_ATTEMPTS=3
DB_RETRY_DELAY_MS=1000
DB_RETRY_BACKOFF_FACTOR=2

# Health Check Configuration
DB_HEALTH_CHECK_ENABLED=true
DB_HEALTH_CHECK_INTERVAL=30000
DB_HEALTH_CHECK_TIMEOUT=5000

# Migration Configuration
DB_MIGRATIONS_TABLE=schema_migrations
DB_MIGRATIONS_DIR=./src/database/migrations

# Audit Configuration
DB_AUDIT_ENABLED=true
DB_AUDIT_RETENTION_DAYS=90

# =====================================================
# CLOUDFLARE CONFIGURATION
# =====================================================

# Cloudflare Worker
CLOUDFLARE_ENABLED=true
CLOUDFLARE_WORKER_URL=https://database-api.your-domain.workers.dev
CLOUDFLARE_SCRIPT_NAME=database-api
CLOUDFLARE_ENVIRONMENT=production
CLOUDFLARE_COMPATIBILITY_DATE=2024-01-01
CLOUDFLARE_COMPATIBILITY_FLAGS=

# Authentication
CLOUDFLARE_API_TOKEN=your-api-token
CLOUDFLARE_ACCOUNT_ID=your-account-id
CLOUDFLARE_ZONE_ID=your-zone-id
CLOUDFLARE_EMAIL=your-email@domain.com
CLOUDFLARE_GLOBAL_API_KEY=your-global-api-key

# Rate Limiting
CLOUDFLARE_RATE_LIMITING_ENABLED=true
CLOUDFLARE_RATE_LIMIT_RPM=1000
CLOUDFLARE_BURST_LIMIT=100
CLOUDFLARE_WINDOW_SIZE=60
CLOUDFLARE_BLOCK_DURATION=300
CLOUDFLARE_WHITELIST_IPS=
CLOUDFLARE_BLACKLIST_IPS=

# DDoS Protection
CLOUDFLARE_DDOS_PROTECTION_ENABLED=true
CLOUDFLARE_DDOS_SENSITIVITY=medium
CLOUDFLARE_CHALLENGE_MODE=js_challenge
CLOUDFLARE_UNDER_ATTACK_MODE=false

# SSL/TLS Configuration
CLOUDFLARE_SSL_MODE=full_strict
CLOUDFLARE_MIN_TLS_VERSION=1.2
CLOUDFLARE_CA=lets_encrypt
CLOUDFLARE_ALWAYS_HTTPS=true
CLOUDFLARE_AUTO_HTTPS_REWRITES=true

# HSTS Configuration
CLOUDFLARE_HSTS_ENABLED=true
CLOUDFLARE_HSTS_MAX_AGE=31536000
CLOUDFLARE_HSTS_SUBDOMAINS=true
CLOUDFLARE_HSTS_PRELOAD=true

# Caching Configuration
CLOUDFLARE_CACHING_ENABLED=true
CLOUDFLARE_CACHE_LEVEL=aggressive
CLOUDFLARE_BROWSER_CACHE_TTL=14400
CLOUDFLARE_EDGE_CACHE_TTL=7200
CLOUDFLARE_ALWAYS_ONLINE=true
CLOUDFLARE_DEV_MODE=false

# Performance Optimization
CLOUDFLARE_MINIFY_CSS=true
CLOUDFLARE_MINIFY_HTML=true
CLOUDFLARE_MINIFY_JS=true
CLOUDFLARE_BROTLI=true
CLOUDFLARE_GZIP=true
CLOUDFLARE_HTTP2=true
CLOUDFLARE_HTTP3=true
CLOUDFLARE_EARLY_HINTS=true

# Database Proxy
CLOUDFLARE_DB_PROXY_ENABLED=true
CLOUDFLARE_DB_POOLING=true
CLOUDFLARE_DB_MAX_CONNECTIONS=10
CLOUDFLARE_DB_TIMEOUT=30000
CLOUDFLARE_DB_QUERY_TIMEOUT=60000
CLOUDFLARE_DB_RETRY_ATTEMPTS=3
CLOUDFLARE_DB_RETRY_DELAY=1000

# Monitoring and Analytics
CLOUDFLARE_ANALYTICS_ENABLED=true
CLOUDFLARE_WEB_ANALYTICS_ENABLED=true
CLOUDFLARE_LOG_RETENTION=30
CLOUDFLARE_RUM_ENABLED=true
CLOUDFLARE_PERF_MONITORING=true

# Security Headers
CLOUDFLARE_CSP=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';
CLOUDFLARE_X_FRAME_OPTIONS=DENY
CLOUDFLARE_X_CONTENT_TYPE_OPTIONS=nosniff
CLOUDFLARE_REFERRER_POLICY=strict-origin-when-cross-origin
CLOUDFLARE_PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()

# =====================================================
# API SERVER CONFIGURATION
# =====================================================

# Server Settings
API_PORT=3000
API_HOST=0.0.0.0
API_BASE_PATH=/api/v1

# Authentication
ENABLE_AUTH=true
API_KEY=your-secure-api-key
JWT_SECRET=your-jwt-secret

# CORS Configuration
CLOUDFLARE_CORS_ENABLED=true
CLOUDFLARE_CORS_ORIGINS=https://your-domain.com,https://app.your-domain.com
CLOUDFLARE_CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CLOUDFLARE_CORS_HEADERS=Content-Type,Authorization,X-Requested-With,X-API-Key

# Request Limits
CLOUDFLARE_MAX_REQUEST_SIZE=10
CLOUDFLARE_REQUEST_TIMEOUT=30000
MAX_REQUEST_SIZE=10mb

# Rate Limiting
RATE_LIMIT_RPM=1000

# Logging
ENABLE_API_LOGGING=true
DEBUG_MODE=false

# =====================================================
# INTEGRATION CONFIGURATION
# =====================================================

# Linear Integration
LINEAR_API_KEY=your-linear-api-key
LINEAR_TEAM_ID=your-team-id
LINEAR_WEBHOOK_SECRET=your-webhook-secret

# GitHub Integration
GITHUB_TOKEN=your-github-token
GITHUB_WEBHOOK_SECRET=your-github-webhook-secret
GITHUB_APP_ID=your-github-app-id
GITHUB_PRIVATE_KEY=your-github-private-key

# AgentAPI Integration
AGENTAPI_URL=https://your-agentapi.com
AGENTAPI_TOKEN=your-agentapi-token

# Claude Code Integration
CLAUDE_CODE_URL=https://your-claude-code.com
CLAUDE_CODE_TOKEN=your-claude-code-token

# Codegen Integration
CODEGEN_API_URL=https://api.codegen.sh
CODEGEN_API_KEY=your-codegen-api-key

# =====================================================
# MONITORING AND LOGGING
# =====================================================

# Application Monitoring
NODE_ENV=production
LOG_LEVEL=info
LOG_FORMAT=json

# Error Tracking
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=production

# Metrics Collection
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8080
HEALTH_CHECK_PATH=/health

# =====================================================
# TESTING CONFIGURATION
# =====================================================

# Test Database (for running tests)
DB_TEST_HOST=localhost
DB_TEST_PORT=5432
DB_TEST_NAME=test_db
DB_TEST_USER=test_user
DB_TEST_PASSWORD=test_password
DB_TEST_URL=postgresql://test_user:test_password@localhost:5432/test_db

# Test API Configuration
API_TEST_PORT=3001
API_TEST_KEY=test-api-key

# =====================================================
# DEVELOPMENT CONFIGURATION
# =====================================================

# Development Mode Settings (override production settings)
# Uncomment these for development

# DEBUG_MODE=true
# DB_LOG_QUERIES=true
# CLOUDFLARE_DEV_MODE=true
# CLOUDFLARE_CACHING_ENABLED=false
# CLOUDFLARE_RATE_LIMITING_ENABLED=false
# LOG_LEVEL=debug

# =====================================================
# SECURITY NOTES
# =====================================================

# IMPORTANT SECURITY CONSIDERATIONS:
# 1. Never commit this file with real credentials to version control
# 2. Use strong, unique passwords for all services
# 3. Rotate API keys and tokens regularly
# 4. Use environment-specific configurations
# 5. Enable SSL/TLS for all connections
# 6. Regularly update dependencies and security patches
# 7. Monitor logs for suspicious activity
# 8. Use least-privilege access principles
# 9. Enable audit logging for all database changes
# 10. Implement proper backup and disaster recovery procedures

# =====================================================
# DEPLOYMENT NOTES
# =====================================================

# For production deployment:
# 1. Set NODE_ENV=production
# 2. Use secure, randomly generated secrets
# 3. Enable all security features
# 4. Configure proper monitoring and alerting
# 5. Set up automated backups
# 6. Use infrastructure as code (IaC) for reproducible deployments
# 7. Implement blue-green or rolling deployments
# 8. Configure load balancing and auto-scaling
# 9. Set up proper DNS and CDN configuration
# 10. Test disaster recovery procedures regularly

